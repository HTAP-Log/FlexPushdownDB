project("normal-pushdown" VERSION "${PROJECT_VERSION}" LANGUAGES C CXX)


setDefaults()


#-----------------------------------------------------------------------------------------------------------------------
# Target
#-----------------------------------------------------------------------------------------------------------------------

add_library(normal-pushdown STATIC
        src/io/CSVParser.cpp
        src/io/CSVParser.h
        include/normal/pushdown/Globals.h
        src/Collate.cpp include/normal/pushdown/Collate.h
        src/S3SelectScan.cpp include/normal/pushdown/S3SelectScan.h
        src/FileScan.cpp include/normal/pushdown/FileScan.h
        src/Aggregate.cpp include/normal/pushdown/Aggregate.h
        src/s3/S3SelectParser.cpp src/s3/S3SelectParser.h
        src/aggregate/AggregationResult.cpp include/normal/pushdown/aggregate/AggregationResult.h
        src/aggregate/Sum.cpp include/normal/pushdown/aggregate/Sum.h
        src/aggregate/AggregationFunction.cpp include/normal/pushdown/aggregate/AggregationFunction.h
        src/AWSClient.cpp include/normal/pushdown/AWSClient.h
        )

target_compile_features(normal-pushdown PRIVATE cxx_std_17)
target_compile_options(normal-pushdown PRIVATE -Wall -Wextra -pedantic)
set_target_properties(normal-pushdown PROPERTIES LINKER_LANGUAGE CXX)

target_include_directories(normal-pushdown PUBLIC include)

target_link_libraries(normal-pushdown PUBLIC normal-core)
target_link_libraries(normal-pushdown PRIVATE spdlog::spdlog)
target_link_libraries(normal-pushdown PUBLIC aws-cpp-sdk-core)
target_link_libraries(normal-pushdown PUBLIC aws-cpp-sdk-s3)
target_link_libraries(normal-pushdown PUBLIC arrow_static)
target_link_libraries(normal-pushdown PUBLIC arrow_dataset_static)
target_link_libraries(normal-pushdown PUBLIC pthread)


#-----------------------------------------------------------------------------------------------------------------------
# Diagnostics
#-----------------------------------------------------------------------------------------------------------------------

#showTargetProps(normal-pushdown)
